$(document).ready(function(){var c=$(window),r=$(document),s={mobileS:375,mobile:680,tablet:768,desktop:992,wide:1336,hd:1680},a=[.02,.01,.47,1];function t(){var a,e,i,s,t,o,n;svg4everybody(),window.viewportUnitsBuggyfill.init({force:!0,refreshDebounceWait:150,appendToBody:!0}),$(".header__menu li").each(function(e,i){$(i).find("a").attr("href")==window.location.pathname.split("/").pop()?$(i).addClass("is-active"):$(i).removeClass("is-active")}),c.on("scroll",throttle(function(e){var i=c.scrollTop(),a=$(".header").not(".header--static"),s=a.height(),t=0;0<r.find(".hero").length&&(t=r.find(".page__content div:first-child()").height()-s),s<i?a.addClass("is-fixed"):a.removeClass("is-fixed"),t<i?a.addClass("is-fixed-visible"):a.removeClass("is-fixed-visible")},10)),f(),$("[js-selectric]").each(function(e,i){var a=$(i).data("icon")||"drop-arrow",s='<b class="button"><svg class="ico ico-'+a+'"><use xlink:href="img/sprite.svg#ico-'+a+'"></use></svg></b>';$(i).selectric({maxHeight:300,arrowButtonMarkup:s,onInit:function(e,i){var a=$(e),s=a.closest("."+i.classes.wrapper);s.find(".label").html(a.attr("placeholder"))},onBeforeOpen:function(e,i){var a=$(e),s=a.closest("."+i.classes.wrapper);s.find(".label").data("value",s.find(".label").html()).html(a.attr("placeholder"))},onBeforeClose:function(e,i){var a=$(e),s=a.closest("."+i.classes.wrapper);s.find(".label").html(s.find(".label").data("value"))}})}),a=0,r.on("click","[js-popup]",function(e){var i=$(e.target).attr("href");$.magnificPopup.open({items:{src:i},type:"inline",fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"popup-buble",closeMarkup:'<button title="%title%" type="button" class="mfp-close"><svg class="ico ico-close"><use xlink:href="img/sprite.svg#ico-close"></use></svg></button>',callbacks:{beforeOpen:function(){a=c.scrollTop()},close:function(){c.scrollTop(a)}}})}),$("[js-popupVideo]").magnificPopup({type:"iframe",fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"popup-buble",patterns:{youtube:{index:"youtube.com/",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1&controls=0&showinfo=0"}}}),r.on("click","[js-popupVideo]",function(e){e.preventDefault(),e.stopPropagation()}),$("[js-popup-gallery]").magnificPopup({delegate:".gallery__main-slide:not(.swiper-slide-duplicate) a",type:"image",tLoading:"Загрузка #%curr%...",mainClass:"popup-buble",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.'}}),m(),w(),$("[js-dateMask]").mask("99.99.99",{placeholder:"ДД.ММ.ГГ"}),$("input[type='tel']").mask("+7 (000) 000-0000",{placeholder:"+7 (___) ___-____"}),$("[js-mask-number]").mask("999 999 999"),r.on("keydown","[js-mask-price]",function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110])||65==e.keyCode&&!0===e.ctrlKey||35<=e.keyCode&&e.keyCode<=39||((e.shiftKey||e.keyCode<48||57<e.keyCode)&&(e.keyCode<96||105<e.keyCode)&&e.preventDefault(),10<$(this).val().length&&e.preventDefault())}).on("keyup","[js-mask-price]",function(e){0<$(this).val().length&&($(this).val($(this).val().replace(/ /g,"")),$(this).val($(this).val().replace(/\B(?=(\d{3})+(?!\d))/g," ")))}),r.find("[js-lazy]").Lazy({threshold:500,enableThrottle:!0,throttle:100,scrollDirection:"vertical",effect:"fadeIn",effectTime:350,onError:function(e){console.log("error loading "+e.data("src"))},beforeLoad:function(e){}}),0<$("[js-scrollbar]").length&&$("[js-scrollbar]").each(function(e,i){if($(i).not(".ps")){var a=$(i).data("x-disable")||!1,s=$(i).data("y-disable")||!1;new PerfectScrollbar(i,{suppressScrollX:a,suppressScrollY:s,wheelPropagation:!0,minScrollbarLength:20})}}),0<(e=$("[js-rangeslider]")).length&&e.each(function(e,i){if(!$(i).is(".noUi-target")){var a=$(i),s=a.data("start-from"),t=a.data("start-to"),o=a.data("step"),n=a.data("range-min"),r=a.data("range-max");noUiSlider.create(i,{start:[s,t],connect:!0,step:o,behaviour:"tap",range:{min:n,max:r}});var l=[a.parent().find("[js-range-from]").get(0),a.parent().find("[js-range-to]").get(0)];i.noUiSlider.on("update",function(e,i){var a=parseInt(e[1]).toFixed(0)>=r?" +":"";l[0].innerHTML=parseInt(e[0]).toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),l[1].innerHTML=parseInt(e[1]).toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+a}),i.noUiSlider.on("change",function(e,i){0<a.closest("form").length&&a.closest("form").trigger("change")}),i.noUiSlider.on("end",function(e,i){a.parent().parent().click(),a.parent().parent().trigger("tap"),a.focusout(),_(!1)})}}),0<(i=$("[js-autocomplete]")).length&&i.each(function(e,i){$(i).easyAutocomplete({url:$(i).data("url"),getValue:"name",list:{match:{enabled:!0},showAnimation:{type:"fade",time:200},hideAnimation:{type:"slide",time:200}}})}),g(),v(),s=function(e){$(e).addClass("has-error")},t=function(e){$(e).removeClass("has-error")},$("[js-validate-cb]").validate({errorPlacement:function(e,i){e.addClass("ui-input__validation"),e.appendTo(i.parent())},highlight:s,unhighlight:t,submitHandler:function(a){$(a).addClass("loading"),$.ajax({type:"POST",url:$(a).attr("action"),data:$(a).serialize(),success:function(e){$(a).removeClass("loading");var i=$.parseJSON(e);"success"==i.status||$(a).find("[data-error]").html(i.message).show()}}),$(a).hide(),$(a).parent().find(".cb__form-thanks").fadeIn()},rules:{name:"required",email:{required:!0,email:!0},message:"required"},messages:{name:"Заполните это поле",email:{required:"Заполните это поле",email:"Email содержит неправильный формат"},message:"Заполните это поле"}}),$("[js-validate-subscribe]").validate({errorPlacement:function(e,i){i.closest(".footer__subscribe").find(".ui-input__validation").remove(),e.addClass("ui-input__validation"),e.appendTo(i.closest(".footer__subscribe"))},highlight:s,unhighlight:t,submitHandler:function(a){$(a).addClass("loading"),$.ajax({type:"POST",url:$(a).attr("action"),data:$(a).serialize(),success:function(e){$(a).removeClass("loading");var i=$.parseJSON(e);"success"==i.status||$(a).find("[data-error]").html(i.message).show()}})},rules:{email:{required:!0,email:!0}},messages:{email:{required:"Заполните это поле",email:"Email содержит неправильный формат"}}}),0<$("#property-map").length&&ymaps.ready(function(){o=new ymaps.Map("property-map",{center:[55.76,37.64],zoom:12}),n=new ymaps.Placemark([55.76,37.64],{hintContent:"Москва!",balloonContent:"Столица России"}),o.geoObjects.add(n)}),function(){var i=function(){m(!0),w(),g(),v(!0),d(),u()},a=function(){v(),m(),_()};if(window.matchMedia){var e=window.matchMedia("print");e.addListener(function(e){e.matches?i():a()})}window.onbeforeprint=i,window.onafterprint=a}(),d(),c.on("resize",debounce(d,250)),c.on("scroll",throttle(p,50)),u(),c.on("resize",debounce(u,250)),c.on("resize",debounce(C,200))}t(),c.on("load",function(){}),(0<window.navigator.userAgent.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv\:11\./))&&$("body").addClass("is-ie"),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&$("body").addClass("is-mobile");var i=0;function o(){$(".page__content").attr("style",""),$("body").removeClass("body-lock"),c.scrollTop(i),i=0}function n(e){$("[js-hamburger]").is(".is-active")||0<$(".m-search.is-active").length?(i=c.scrollTop(),$(".page__content").css({"margin-top":"-"+i+"px"}),$("body").addClass("body-lock")):o(),e&&o()}function l(){$("[js-hamburger]").removeClass("is-active"),$("[js-open-header-search]").removeClass("is-active"),$(".header").removeClass("is-menu-opened"),$(".m-navi").removeClass("is-active"),$(".m-search").removeClass("is-active"),n()}function d(){if(0<$("[js-scrolltop]").length){var e=(c.width()-$(".blog .container").width())/2;$("[js-scrolltop]").css({right:e+"px"})}}function p(){if(0<$("[js-scrolltop]").length){var e=c.scrollTop(),i=e+c.height(),a=$(".post__wrapper").offset().top+$(".post__wrapper").outerHeight();400<e?$("[js-scrolltop]").addClass("is-visible"):$("[js-scrolltop]").removeClass("is-visible"),a<i?$("[js-scrolltop]").addClass("is-stop"):$("[js-scrolltop]").removeClass("is-stop")}}function h(){$(".benefits__tab").each(function(e,i){$(i).is(".is-active")||$(i).hide()})}function u(){$("[js-remove-active-mobile]").each(function(e,i){var a=$(i);c.width()<s.mobile?a.removeClass("is-active"):a.addClass("is-active")})}function f(){setTimeout(function(){$(".h-card.is-loading").removeClass("is-loading")},1e3)}function e(){$(".h-card").addClass("is-loading"),f()}function m(e){new Swiper("[js-hot-slider]",{wrapperClass:"swiper-wrapper",slideClass:"hot-slider__slide",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0,navigation:{nextEl:".hot-slider__next",prevEl:".hot-slider__prev"}}),new Swiper("[js-slider-popular]",{wrapperClass:"swiper-wrapper",slideClass:"popular__col",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0}),new Swiper("[js-slider-benefits]",{wrapperClass:"swiper-wrapper",slideClass:"benefits__col",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0,on:{init:function(){setTimeout(h,200)}}}),new Swiper("[js-slider-blog]",{wrapperClass:"swiper-wrapper",slideClass:"blog__col",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0}),new Swiper("[js-slider-post]",{wrapperClass:"swiper-wrapper",slideClass:"swiper-slide",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:1,normalizeSlideIndex:!0,grabCursor:!0,freeMode:!1,navigation:{nextEl:".post__slider-next",prevEl:".post__slider-prev"}}),$("[js-hotCard-slider]").each(function(e,i){new Swiper($(i),{wrapperClass:"swiper-wrapper",slideClass:"h-card__image",direction:"horizontal",nested:!0,loop:!0,watchOverflow:!1,setWrapperSize:!0,spaceBetween:0,slidesPerView:1,normalizeSlideIndex:!0,navigation:{nextEl:".h-card__images-next",prevEl:".h-card__images-prev"}})}),new Swiper("[js-slider-categories]",{wrapperClass:"swiper-wrapper",slideClass:"swiper-slide",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0});var i=$(".gallery__main .gallery__main-slide").length,a=new Swiper("[js-gallery-main]",{wrapperClass:"swiper-wrapper",slideClass:"gallery__main-slide",direction:"horizontal",nested:!1,loop:!0,loopedSlides:i,watchOverflow:!1,setWrapperSize:!0,spaceBetween:0,slidesPerView:1,touchEventsTarget:"wrapper",normalizeSlideIndex:!0,navigation:{nextEl:".gallery__main-next",prevEl:".gallery__main-prev"}}),s=new Swiper("[js-gallery-thumbs]",{wrapperClass:"swiper-wrapper",slideClass:"gallery__thumbs-slide",direction:"horizontal",nested:!1,loop:!0,loopedSlides:i,watchOverflow:!0,setWrapperSize:!1,spaceBetween:5,slidesPerView:"auto",normalizeSlideIndex:!0,touchRatio:.2,slideToClickedSlide:!0,navigation:{nextEl:".gallery__thumbs-next",prevEl:".gallery__thumbs-prev"}});0<$("[js-gallery-main]").length&&((a.controller.control=s).controller.control=a);var t=new Swiper("[js-slider-plan]",{wrapperClass:"swiper-wrapper",slideClass:"swiper-slide",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:2,normalizeSlideIndex:!0,grabCursor:!0,freeMode:!1,navigation:{nextEl:".property__plan-next",prevEl:".property__plan-prev"},breakpoints:{680:{slidesPerView:1}}});0<$("[js-slider-plan]").length&&(!0===e?t.destroy():t.update())}function v(l){$("[js-teleport]").each(function(e,i){var a=$(i),s=$(i).html(),t=$("[data-teleport-target="+$(i).data("teleport-to")+"]"),o=$(i).data("teleport-condition").substring(1),n=$(i).data("teleport-condition").substring(0,1);if(t&&s&&n){function r(e){var i;"<"===n?i=c.width()<o:">"===n&&(i=c.width()>o),!0===e?(t.html(s),a.html("")):i?(t.html(s),a.html("")):(a.html(s),t.html(""))}1==l?r(l):(r(),c.on("resize",debounce(function(){r(l)},100)))}})}function g(){var e=$("[js-sticky]");0<e.length&&e.each(function(e,i){$(i).stick_in_parent({offset_top:75})})}function w(){$(".wow").each(function(e,i){var a,s=scrollMonitor.create($(i));a=$(window).width()<768?0:$(i).data("animation-delay");var t=$(i).data("animation-class")||"wowFadeUp",o=$(i).data("animation-name")||"wowFade";s.enterViewport(throttle(function(){$(i).addClass(t),$(i).css({"animation-name":o,"animation-delay":a,visibility:"visible"})},100,{leading:!0}))})}r.on("click",'[href="#"]',function(e){e.preventDefault()}).on("click",'a[href^="#section"]',function(){var e=$(this).attr("href");return $("body, html").animate({scrollTop:$(e).offset().top},1e3),!1}).on("click","[js-scrolltop]",function(){$(this).attr("href");return $("body, html").animate({scrollTop:0},1e3),!1}),r.on("click","[js-footer-nav-collapse]",function(e){c.width()<s.tablet&&(0<$(e.target).closest(".footer__nav-list").length?e.stopPropagation():($(this).closest(".footer__nav-collapse").toggleClass("is-opened"),anime({targets:"html, body",scrollTop:$("[js-footer-nav-collapse]").offset().top-48,easing:a,duration:200})))}),r.on("click","[js-hamburger]",function(){$(this).toggleClass("is-active"),$(".header").toggleClass("is-menu-opened"),$(".m-navi").toggleClass("is-active"),n()}).on("click","[js-open-mobile]",function(){var e=$(this).data("target");e&&($("[js-hamburger]").removeClass("is-active"),$("[js-open-header-search]").removeClass("is-active"),$(".header").removeClass("is-menu-opened"),$(".m-navi").removeClass("is-active"),$(".m-search").removeClass("is-active"),$(this).toggleClass("is-active"),$(".header").toggleClass("is-menu-opened"),$('.m-search[data-name="'+e+'"]').toggleClass("is-active"),n())}).on("click","[js-close-mobile]",function(){l()}).on("click","[js-reset-mobile-search]",function(){var e=$(this).closest(".m-search");e.find('input[type="text"]').val(""),e.find('input[type="radio"]').prop("checked",!1),e.find("[js-rangeslider]").get(0).noUiSlider.reset()}).on("click","[js-reset-mobile-filter]",function(){var e=$(this).closest(".m-search");e.find('input[type="text"]').val(""),e.find('input[type="radio"]').prop("checked",!1),e.find("[js-rangeslider]").get(0).noUiSlider.reset()}),r.on("click","[js-tab]",function(e){var i=$(this).data("target"),a=$("[data-tab="+i+"]");i&&a&&($(this).siblings().removeClass("is-active"),$(this).addClass("is-active"),a.siblings().slideUp(),a.slideDown(),_(!1))}).on("click",".property__tab-mobile",function(e){$(this).parent().toggleClass("is-active")}),r.on("click","[js-search-reset]",function(e){var i=$(this).closest("form");i.find('input[type="text"]').val(""),i.find('input[type="radio"]').prop("checked",!1),i.find("[js-rangeslider]").each(function(e,i){i.noUiSlider.reset()}),$("[js-search-apply]").fadeOut()}).on("click","[js-search-apply]",function(){$("[js-search-apply]").fadeOut(),e()}).on("change","[js-search-filter]",function(){e()}).on("change","[js-search-form]",function(){$("[js-search-apply]").fadeIn()}).on("click",".page-information__paragraph-head",function(){$(this).toggleClass("is-active"),$(this).parent().find(".page-information__paragraph-drop").slideToggle()}),r.on("click","[js-open-share]",function(e){$("[js-open-share]").toggleClass("is-active"),$(".property__share-drop").toggleClass("is-active")}).on("click",function(e){0<!$(e.target).closest(".property__share").length&&($("[js-open-share]").removeClass("is-active"),$(".property__share-drop").removeClass("is-active"))}).on("click","[js-print]",function(e){window.print()}),r.on("click",".mfp-close",function(){$.magnificPopup.close()}),r.one("focus.autoExpand",".ui-group textarea",function(){var e=this.value;this.value="",this.baseScrollHeight=this.scrollHeight,this.value=e}).on("input.autoExpand",".ui-group textarea",function(){var e,i=0|this.getAttribute("data-min-rows");this.rows=i,e=Math.ceil((this.scrollHeight-this.baseScrollHeight)/17),this.rows=i+e}),r.on("keyup","[js-search-hints]",debounce(function(e){e.preventDefault(),e.stopPropagation();var i=$(this).val(),a=$(this).parent().find(".s-hints");i.length<=2||(a.find(".s-hints__section").remove(),a.addClass("is-active").removeClass("is-loaded"),i.match("^нет")||$.get("/json/api-hints.json").done(function(e){var i=e.tags,t=e.items,o="";if(0<i.length&&$.each(i,function(e,i){var a="";$.each(i.items,function(e,i){a+='<li data-query-value="'+i.value+'"><a href="#">'+i.label+"</a></li>"}),o+='\x3c!-- section  --\x3e<div class="s-hints__section" data-query-name="'+i.name+'"><div class="s-hints__section-name">'+i.title+'</div><ul class="s-hints__list">'+a}),0<t.length){var n="";$.each(t,function(e,i){var a=void 0!==i.price.postfix?i.price.postfix:"",s=void 0!==i.price.prefix?i.price.prefix:"";n+='<li><a class="s-hints-property" href="'+i.url+'" target="_blank"><div class="s-hints-property__image"><img src="'+i.images[0]+'" srcset="'+i.images[1]+' 2x"></div><div class="s-hints-property__content"><div class="s-hints-property__id">ID '+i.id+'</div><div class="s-hints-property__name">'+i.name+'</div><div class="s-hints-property__price"><span>'+s+"</span> "+i.price.value+" <span>"+a+"</span></div></div></a></li>",e===t.length-1&&(o+='<div class="s-hints__section"><div class="s-hints__section-name">Объекты недвижимости</div><ul class="s-hints__list">'+n)})}setTimeout(function(){a.find(".s-hints__wrapper").append(o),a.addClass("is-loaded")},1e3)}).fail(function(e){a.removeClass("is-active").removeClass("is-loaded"),console.log(e)}))},200)).on("click","[js-close-hints]",function(){$(this).closest(".s-hints").removeClass("is-active").removeClass("is-loaded")}).on("click",function(e){0<!$(e.target).closest(".header-search").length&&$(".s-hints").removeClass("is-active").removeClass("is-loaded")}),Barba.Pjax.Dom.containerClass="page";var b=Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.fadeOut()]).then(this.fadeIn.bind(this))},fadeOut:function(){var i=Barba.Utils.deferred();return anime({targets:this.oldContainer,opacity:.5,easing:a,duration:300,complete:function(e){i.resolve()}}),i.promise},fadeIn:function(){var i=this,e=$(this.newContainer);$(this.oldContainer).hide(),e.css({visibility:"visible",opacity:.5}),anime({targets:"html, body",scrollTop:1,easing:a,duration:150}),anime({targets:this.newContainer,opacity:1,easing:a,duration:300,complete:function(e){_(),i.done()}})}});function _(e){e&&c.scrollTop(0),$(window).scroll(),$(window).resize()}function C(){var e=window.location.host.toLowerCase();if(0<=e.indexOf("localhost")||0<=e.indexOf("surge")){var i="<div class='dev-bp-debug'>"+c.width()+"</div>";$(".page").append(i),setTimeout(function(){$(".dev-bp-debug").fadeOut()},1e3),setTimeout(function(){$(".dev-bp-debug").remove()},1500)}}Barba.Pjax.getTransition=function(){return b},Barba.Prefetch.init(),Barba.Pjax.start(),Barba.Dispatcher.on("newPageReady",function(e,i,a,s){t(),l()})});