$(document).ready(function(){var d=$(window),r=$(document),p={},s={mobileS:375,mobile:680,tablet:768,desktop:992,wide:1336,hd:1680},a=[.02,.01,.47,1];function t(){var e,i,a,s,t,n;svg4everybody(),window.viewportUnitsBuggyfill.init({force:!0,refreshDebounceWait:150,appendToBody:!0}),$(".header__menu li").each(function(e,i){$(i).find("a").attr("href")==window.location.pathname.split("/").pop()?$(i).addClass("is-active"):$(i).removeClass("is-active")}),d.on("scroll",throttle(function(e){var i=d.scrollTop(),a=$(".header").not(".header--static"),s=a.height(),t=0;0<r.find(".hero").length&&(t=r.find(".page__content div:first-child()").height()-s),s<i?a.addClass("is-fixed"):a.removeClass("is-fixed"),t<i?a.addClass("is-fixed-visible"):a.removeClass("is-fixed-visible")},10)),""===window.location.search&&(window.location.search=$("[js-default-query]").data("query")),v(),$("[js-selectric]").each(function(e,i){var a=$(i).data("icon")||"drop-arrow",s='<b class="button"><svg class="ico ico-'+a+'"><use xlink:href="img/sprite.svg#ico-'+a+'"></use></svg></b>';$(i).selectric({maxHeight:300,arrowButtonMarkup:s,onInit:function(e,i){var a=$(e),s=a.closest("."+i.classes.wrapper);s.find(".label").html(a.attr("placeholder"))},onBeforeOpen:function(e,i){var a=$(e),s=a.closest("."+i.classes.wrapper);s.find(".label").data("value",s.find(".label").html()).html(a.attr("placeholder"))},onBeforeClose:function(e,i){var a=$(e),s=a.closest("."+i.classes.wrapper);s.find(".label").html(s.find(".label").data("value"))}})}),w(),m(),k(),$("[js-dateMask]").mask("99.99.99",{placeholder:"ДД.ММ.ГГ"}),$("input[type='tel']").mask("+7 (000) 000-0000",{placeholder:"+7 (___) ___-____"}),$("[js-mask-number]").mask("999 999 999"),r.on("keydown","[js-mask-price]",function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110])||65==e.keyCode&&!0===e.ctrlKey||35<=e.keyCode&&e.keyCode<=39||((e.shiftKey||e.keyCode<48||57<e.keyCode)&&(e.keyCode<96||105<e.keyCode)&&e.preventDefault(),10<$(this).val().length&&e.preventDefault())}).on("keyup","[js-mask-price]",function(e){0<$(this).val().length&&($(this).val($(this).val().replace(/ /g,"")),$(this).val($(this).val().replace(/\B(?=(\d{3})+(?!\d))/g," ")))}),r.find("[js-lazy]").Lazy({threshold:500,enableThrottle:!0,throttle:100,scrollDirection:"vertical",effect:"fadeIn",effectTime:350,onError:function(e){console.log("error loading "+e.data("src"))},beforeLoad:function(e){}}),0<$("[js-scrollbar]").length&&$("[js-scrollbar]").each(function(e,i){if($(i).not(".ps")){var a=$(i).data("x-disable")||!1,s=$(i).data("y-disable")||!1,t=void 0===$(i).data("propagation");new PerfectScrollbar(i,{suppressScrollX:a,suppressScrollY:s,wheelPropagation:t,minScrollbarLength:20})}}),0<(e=$("[js-rangeslider]")).length&&e.each(function(e,i){if(!$(i).is(".noUi-target")){var n=$(i),a=n.data("start-from"),s=n.data("start-to"),t=n.data("step"),r=n.data("range-min"),o=n.data("range-max");noUiSlider.create(i,{start:[a,s],connect:!0,step:t,behaviour:"tap",range:{min:r,max:o}});var l=[n.parent().find("[js-range-from]").get(0),n.parent().find("[js-range-to]").get(0)];i.noUiSlider.on("update",function(e,i){var a=parseInt(e[1]).toFixed(0)>=o?" +":"";l[0].innerHTML=parseInt(e[0]).toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),l[1].innerHTML=parseInt(e[1]).toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+a}),i.noUiSlider.on("change",function(e,i){0<n.closest("form").length&&n.closest("form").trigger("change")}),i.noUiSlider.on("end",function(e,i){n.parent().parent().click(),n.parent().parent().trigger("tap"),n.focusout(),S(!1);var a=n.closest("[js-query-builder]");if(0<a.length){var s=a.data("query-name"),t=a.data("query-min-max");s&&1==t&&(C(s+"-min",Math.floor(e[0])),C(s+"-max",Math.floor(e[1])))}})}}),0<(i=$("[js-autocomplete]")).length&&i.each(function(e,i){$(i).easyAutocomplete({url:$(i).data("url"),getValue:"name",list:{match:{enabled:!0},showAnimation:{type:"fade",time:200},hideAnimation:{type:"slide",time:200}}})}),b(),_(),a=function(e){$(e).addClass("has-error")},s=function(e){$(e).removeClass("has-error")},$("[js-validate-cb]").validate({errorPlacement:function(e,i){e.addClass("ui-input__validation"),e.appendTo(i.parent())},highlight:a,unhighlight:s,submitHandler:function(a){$(a).addClass("loading"),$.ajax({type:"POST",url:$(a).attr("action"),data:$(a).serialize(),success:function(e){$(a).removeClass("loading");var i=$.parseJSON(e);"success"==i.status||$(a).find("[data-error]").html(i.message).show()}}),$(a).hide(),$(a).parent().find(".cb__form-thanks").fadeIn()},rules:{name:"required",email:{required:!0,email:!0},message:"required"},messages:{name:"Заполните это поле",email:{required:"Заполните это поле",email:"Email содержит неправильный формат"},message:"Заполните это поле"}}),$("[js-validate-subscribe]").validate({errorPlacement:function(e,i){i.closest(".footer__subscribe").find(".ui-input__validation").remove(),e.addClass("ui-input__validation"),e.appendTo(i.closest(".footer__subscribe"))},highlight:a,unhighlight:s,submitHandler:function(a){$(a).addClass("loading"),$.ajax({type:"POST",url:$(a).attr("action"),data:$(a).serialize(),success:function(e){$(a).removeClass("loading");var i=$.parseJSON(e);"success"==i.status||$(a).find("[data-error]").html(i.message).show()}})},rules:{email:{required:!0,email:!0}},messages:{email:{required:"Заполните это поле",email:"Email содержит неправильный формат"}}}),0<$("#property-map").length&&ymaps.ready(function(){t=new ymaps.Map("property-map",{center:[55.76,37.64],zoom:12}),n=new ymaps.Placemark([55.76,37.64],{hintContent:"Москва!",balloonContent:"Столица России"}),t.geoObjects.add(n)}),function(){var i=function(){m(!0),k(),b(),_(!0),c(),f()},a=function(){_(),m(),S()};if(window.matchMedia){var e=window.matchMedia("print");e.addListener(function(e){e.matches?i():a()})}window.onbeforeprint=i,window.onafterprint=a}(),function(){var e,i=/\+/g,a=/([^&=]+)=?([^&]*)/g,s=function(e){return decodeURIComponent(e.replace(i," "))},t=window.location.search.substring(1);for(;e=a.exec(t);)p[s(e[1])]=s(e[2]);console.log("urlParams",p),$.each(p,function(e,i){var s=e;-1!==e.indexOf("-min")&&(s=s.slice(0,-4));var t=$('[data-query-name="'+s+'"]');if(t.is(".slider-group")){var a=t.find("[js-rangeslider]");setTimeout(function(){a.each(function(e,i){i.noUiSlider.set([p[s+"-min"],p[s+"-max"]])})},300)}else if(t.is(".ui-group")){var n=p[s].split(";"),r=t.find("input[type='checkbox']");r.each(function(e,i){var a=$(i);-1!==n.indexOf(a.val())&&a.attr("checked",!0)})}else if(t.is(".search__filter-select"))setTimeout(function(){var a,e=t.find("[js-selectric]"),i=e.find("option");i.each(function(e,i){$(i).val()===p[s]&&(a=$(i).index())}),e.prop("selectedIndex",a).selectric("refresh")},300);else if(-1!==e.indexOf("tag-")){var o=e.split("tag-")[1],l=p[e],c=$("[js-search-container]");c.each(function(e,i){var t=$(i);$.get("/json/api-tags.json?q="+o+l).done(function(e){var s;$.each(e.tags,function(e,i){if(i.name==="tag-"+o&&i.value===l){s=i.label;var a='<div data-query-name="tag-'+o+'" data-query-value="'+l+'" class="s-hint-suggestion"> <span>'+s+'</span><svg class="ico ico-close"><use xlink:href="img/sprite.svg#ico-close"></use></svg></div>';t.find("[js-search-tags]").append(a),t.addClass("is-active"),y(t)}})}).fail(function(e){console.log(e)})})}})}(),c(),d.on("resize",debounce(c,250)),d.on("scroll",throttle(u,50)),f(),d.on("resize",debounce(f,250)),d.on("resize",debounce(z,200))}t(),(0<window.navigator.userAgent.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv\:11\./))&&$("body").addClass("is-ie"),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&$("body").addClass("is-mobile");var i=0;function n(){$(".page__content").attr("style",""),$("body").removeClass("body-lock"),d.scrollTop(i),i=0}function o(e){$("[js-hamburger]").is(".is-active")||0<$(".m-search.is-active").length?(i=d.scrollTop(),$(".page__content").css({"margin-top":"-"+i+"px"}),$("body").addClass("body-lock")):n(),e&&n()}function l(){$("[js-hamburger]").removeClass("is-active"),$("[js-open-header-search]").removeClass("is-active"),$(".header").removeClass("is-menu-opened"),$(".m-navi").removeClass("is-active"),$(".m-search").removeClass("is-active"),o()}function c(){if(0<$("[js-scrolltop]").length){var e=(d.width()-$(".blog .container").width())/2;$("[js-scrolltop]").css({right:e+"px"})}}function u(){if(0<$("[js-scrolltop]").length){var e=d.scrollTop(),i=e+d.height(),a=$(".post__wrapper").offset().top+$(".post__wrapper").outerHeight();400<e?$("[js-scrolltop]").addClass("is-visible"):$("[js-scrolltop]").removeClass("is-visible"),a<i?$("[js-scrolltop]").addClass("is-stop"):$("[js-scrolltop]").removeClass("is-stop")}}function h(){$(".benefits__tab").each(function(e,i){$(i).is(".is-active")||$(i).hide()})}function f(){$("[js-remove-active-mobile]").each(function(e,i){var a=$(i);d.width()<s.mobile?a.removeClass("is-active"):a.addClass("is-active")})}function v(){$(".h-card").addClass("is-loading"),$gridContainer=$(".search__grid");var e=$gridContainer.closest("[data-properties-query-url]").data("properties-query-url");if(0<$gridContainer.length&&e){var i=e+window.location.search;$.get(i).done(function(e){var i,r;i=e.items,r="",0<i.length&&($.each(i,function(e,i){var s="";0<i.carousel.length&&$.each(i.carousel,function(e,i){if(i.url)var a='<i class="icon icon-play" href="'+i.url+'" js-popupVideo></i>';s+='<div class="h-card__image">'+a+'<img src="'+i.images[0]+'" srcset="'+i.images[1]+' 2x"></div>'});var a="";0<i.meta.length&&$.each(i.meta,function(e,i){a+="<span>"+i+"</span>"});var t=void 0!==i.price.postfix?i.price.postfix:"",n=void 0!==i.price.prefix?i.price.prefix:"";r+='<div class="search__col"><div class="h-card is-loading"><div class="h-card__images swiper-wrapper" js-hotCard-slider><div class="swiper-wrapper">'+s+'</div><div class="h-card__images-next"><svg class="ico ico-arrow-right"><use xlink:href="img/sprite.svg#ico-arrow-right"></use></svg></div><div class="h-card__images-prev"><svg class="ico ico-arrow-left"><use xlink:href="img/sprite.svg#ico-arrow-left"></use></svg></div></div><div class="h-card__content"><div class="h-card__info"> '+a+' </div><a class="h-card__name" href="'+i.url+'">'+i.name+'</a><div class="h-card__addres">'+i.address+'</div><div class="h-card__price">'+(n?"<span>"+n+"</span>":"")+i.price.value+"<span>"+t+"</span></div></div></div></div>"}),$gridContainer.html(""),$gridContainer.append(r)),function(e){var a=e.pages,i=e.count,s="",t=$("[js-pagination]");if(a&&i){var n="",r=function(e,i){for(var a,s=i,t=e-1,n=e+1+1,r=[],o=[],l=1;l<=s;l++)(1==l||l==s||t<=l&&l<n)&&r.push(l);var c=!0,d=!1,p=void 0;try{for(var u,h=r[Symbol.iterator]();!(c=(u=h.next()).done);c=!0){var f=u.value;a&&(f-a==2?o.push(a+1):f-a!=1&&o.push("...")),o.push(f),a=f}}catch(e){d=!0,p=e}finally{try{!c&&h.return&&h.return()}finally{if(d)throw p}}return o}(a.active,a.count);$.each(r,function(e,i){n+="..."!==i?'<li class="'+(i===a.active?"is-active":"")+'" data-page="'+i+'"><a href="#">'+i+"</a></li>":'<li class="pagination__break"><svg class="ico ico-pagination-break"><use xlink:href="img/sprite.svg#ico-pagination-break"></use></svg></li>'});var o=e.from+"-"+e.to;s+='<div class="pagination__scope">'+o+" из "+i+'</div><div class="pagination__list" js-pagination>'+n+"</div>",t.html(""),t.append(s)}}(e)}).fail(function(e){g()})}g()}function g(){setTimeout(function(){m(),w(),$(".h-card.is-loading").removeClass("is-loading")},500)}function m(e){new Swiper("[js-hot-slider]",{wrapperClass:"swiper-wrapper",slideClass:"hot-slider__slide",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0,navigation:{nextEl:".hot-slider__next",prevEl:".hot-slider__prev"}}),new Swiper("[js-slider-popular]",{wrapperClass:"swiper-wrapper",slideClass:"popular__col",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0}),new Swiper("[js-slider-benefits]",{wrapperClass:"swiper-wrapper",slideClass:"benefits__col",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0,on:{init:function(){setTimeout(h,200)}}}),new Swiper("[js-slider-blog]",{wrapperClass:"swiper-wrapper",slideClass:"blog__col",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0}),new Swiper("[js-slider-post]",{wrapperClass:"swiper-wrapper",slideClass:"swiper-slide",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:1,normalizeSlideIndex:!0,grabCursor:!0,freeMode:!1,navigation:{nextEl:".post__slider-next",prevEl:".post__slider-prev"}}),$("[js-hotCard-slider]").each(function(e,i){new Swiper($(i),{wrapperClass:"swiper-wrapper",slideClass:"h-card__image",direction:"horizontal",nested:!0,loop:!0,watchOverflow:!1,setWrapperSize:!0,spaceBetween:0,slidesPerView:1,normalizeSlideIndex:!0,navigation:{nextEl:".h-card__images-next",prevEl:".h-card__images-prev"}})}),new Swiper("[js-slider-categories]",{wrapperClass:"swiper-wrapper",slideClass:"swiper-slide",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:"auto",normalizeSlideIndex:!0,grabCursor:!0,freeMode:!0});var i=$(".gallery__main .gallery__main-slide").length,a=new Swiper("[js-gallery-main]",{wrapperClass:"swiper-wrapper",slideClass:"gallery__main-slide",direction:"horizontal",nested:!1,loop:!0,loopedSlides:i,watchOverflow:!1,setWrapperSize:!0,spaceBetween:0,slidesPerView:1,touchEventsTarget:"wrapper",normalizeSlideIndex:!0,navigation:{nextEl:".gallery__main-next",prevEl:".gallery__main-prev"}}),s=new Swiper("[js-gallery-thumbs]",{wrapperClass:"swiper-wrapper",slideClass:"gallery__thumbs-slide",direction:"horizontal",nested:!1,loop:!0,loopedSlides:i,watchOverflow:!0,setWrapperSize:!1,spaceBetween:5,slidesPerView:"auto",normalizeSlideIndex:!0,touchRatio:.2,slideToClickedSlide:!0,navigation:{nextEl:".gallery__thumbs-next",prevEl:".gallery__thumbs-prev"}});0<$("[js-gallery-main]").length&&((a.controller.control=s).controller.control=a);var t=new Swiper("[js-slider-plan]",{wrapperClass:"swiper-wrapper",slideClass:"swiper-slide",direction:"horizontal",loop:!1,watchOverflow:!0,setWrapperSize:!1,spaceBetween:0,slidesPerView:2,normalizeSlideIndex:!0,grabCursor:!0,freeMode:!1,navigation:{nextEl:".property__plan-next",prevEl:".property__plan-prev"},breakpoints:{680:{slidesPerView:1}}});0<$("[js-slider-plan]").length&&(!0===e?t.destroy():t.update())}function w(){var a=0;r.on("click","[js-popup]",function(e){var i=$(e.target).attr("href");$.magnificPopup.open({items:{src:i},type:"inline",fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"popup-buble",closeMarkup:'<button title="%title%" type="button" class="mfp-close"><svg class="ico ico-close"><use xlink:href="img/sprite.svg#ico-close"></use></svg></button>',callbacks:{beforeOpen:function(){a=d.scrollTop()},close:function(){d.scrollTop(a)}}})}),$("[js-popupVideo]").magnificPopup({type:"iframe",fixedContentPos:!0,fixedBgPos:!0,overflowY:"auto",closeBtnInside:!0,preloader:!1,midClick:!0,removalDelay:300,mainClass:"popup-buble",patterns:{youtube:{index:"youtube.com/",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1&controls=0&showinfo=0"}}}),r.on("click","[js-popupVideo]",function(e){e.preventDefault(),e.stopPropagation()}),$("[js-popup-gallery]").magnificPopup({delegate:".gallery__main-slide:not(.swiper-slide-duplicate) a",type:"image",tLoading:"Загрузка #%curr%...",mainClass:"popup-buble",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.'}})}function _(l){$("[js-teleport]").each(function(e,i){var a=$(i),s=$(i).html(),t=$("[data-teleport-target="+$(i).data("teleport-to")+"]"),n=$(i).data("teleport-condition").substring(1),r=$(i).data("teleport-condition").substring(0,1);if(t&&s&&r){function o(e){var i;"<"===r?i=d.width()<n:">"===r&&(i=d.width()>n),!0===e?(t.html(s),a.html("")):i?(t.html(s),a.html("")):(a.html(s),t.html(""))}1==l?o(l):(o(),d.on("resize",debounce(function(){o(l)},100)))}})}function b(){var e=$("[js-sticky]");0<e.length&&e.each(function(e,i){$(i).stick_in_parent({offset_top:75})})}function y(e){var i;if(e.is(".hints--with-bg"))i=$(".search-form__name"),d.width()<=992?((a=15+e.find(".hints__suggestions").height()-6)<15&&(a=15),i.css({"margin-bottom":a})):i.css({"margin-bottom":0});else if(i=$(".search"),d.width()<=768){var a=125+e.height()-40;i.css({"margin-top":a})}else i.attr("style","")}function C(e,i){window.history.replaceState({},null,x(e,i)),v()}function j(e,i,a){a?window.history.replaceState({},null,window.location.pathname):window.history.replaceState({},null,x(e,null)),v()}function x(e,i,a){a||(a=window.location.href);var s,t=new RegExp("([?&])"+e+"=.*?(&|#|$)(.*)","gi");if(t.test(a))return null!=i?a.replace(t,"$1"+e+"="+i+"$2$3"):(a=(s=a.split("#"))[0].replace(t,"$1$3").replace(/(&|\?)$/,""),void 0!==s[1]&&null!==s[1]&&(a+="#"+s[1]),a);if(null!=i){var n=-1!==a.indexOf("?")?"&":"?";return a=(s=a.split("#"))[0]+n+e+"="+i,void 0!==s[1]&&null!==s[1]&&(a+="#"+s[1]),a}return a}function k(){$(".wow").each(function(e,i){var a,s=scrollMonitor.create($(i));a=$(window).width()<=768?0:$(i).data("animation-delay");var t=$(i).data("animation-class")||"wowFadeUp",n=$(i).data("animation-name")||"wowFade";s.enterViewport(throttle(function(){$(i).addClass(t),$(i).css({"animation-name":n,"animation-delay":a,visibility:"visible"})},100,{leading:!0}))})}r.on("click",'[href="#"]',function(e){e.preventDefault()}).on("click",'a[href^="#section"]',function(){var e=$(this).attr("href");return $("body, html").animate({scrollTop:$(e).offset().top},1e3),!1}).on("click","[js-scrolltop]",function(){$(this).attr("href");return $("body, html").animate({scrollTop:0},1e3),!1}),r.on("click","[js-footer-nav-collapse]",function(e){d.width()<=s.tablet&&(0<$(e.target).closest(".footer__nav-list").length?e.stopPropagation():($(this).closest(".footer__nav-collapse").toggleClass("is-opened"),anime({targets:"html, body",scrollTop:$("[js-footer-nav-collapse]").offset().top-48,easing:a,duration:200})))}),r.on("click","[js-hamburger]",function(){$(this).toggleClass("is-active"),$(".header").toggleClass("is-menu-opened"),$(".m-navi").toggleClass("is-active"),o()}).on("click","[js-open-mobile]",function(){var e=$(this).data("target");e&&($("[js-hamburger]").removeClass("is-active"),$("[js-open-header-search]").removeClass("is-active"),$(".header").removeClass("is-menu-opened"),$(".m-navi").removeClass("is-active"),$(".m-search").removeClass("is-active"),$(this).toggleClass("is-active"),$(".header").toggleClass("is-menu-opened"),$('.m-search[data-name="'+e+'"]').toggleClass("is-active"),o())}).on("click","[js-close-mobile]",function(){l()}).on("click","[js-reset-mobile-search]",function(){var e=$(this).closest(".m-search");e.find('input[type="text"]').val(""),e.find('input[type="radio"]').prop("checked",!1),e.find("[js-rangeslider]").get(0).noUiSlider.reset()}).on("click","[js-reset-mobile-filter]",function(){var e=$(this).closest(".m-search");e.find('input[type="text"]').val(""),e.find('input[type="radio"]').prop("checked",!1),e.find("[js-rangeslider]").get(0).noUiSlider.reset()}),r.on("click","[js-tab]",function(e){var i=$(this).data("target"),a=$("[data-tab="+i+"]");i&&a&&($(this).siblings().removeClass("is-active"),$(this).addClass("is-active"),a.siblings().slideUp(),a.slideDown(),S(!1))}).on("click",".property__tab-mobile",function(e){$(this).parent().toggleClass("is-active")}),r.on("change","[js-search-filter]",function(){C($(this).closest("[js-query-builder]").data("query-name"),$(this).val())}).on("click","[js-search-reset]",function(e){var i=$(this).closest("form");i.find('input[type="text"]').val(""),i.find('input[type="radio"]').prop("checked",!1),i.find('input[type="checkbox"]').prop("checked",!1),i.find("[js-rangeslider]").each(function(e,i){i.noUiSlider.reset()}),j(null,null,!0)}).on("change",'[js-query-builder] input[type="checkbox"]',function(){$(this);var e=$(this).closest("[js-query-builder]"),a=[];e.find('input[type="checkbox"]').each(function(e,i){$(i).is(":checked")&&a.push($(i).val())}),C(e.data("query-name"),a.join(";"))}),r.on("click",".page-information__paragraph-head",function(){$(this).toggleClass("is-active"),$(this).parent().find(".page-information__paragraph-drop").slideToggle()}),r.on("click","[js-pagination] li",function(){C("page",$(this).data("page"))}),r.on("click","[js-open-share]",function(e){$("[js-open-share]").toggleClass("is-active"),$(".property__share-drop").toggleClass("is-active")}).on("click",function(e){0<!$(e.target).closest(".property__share").length&&($("[js-open-share]").removeClass("is-active"),$(".property__share-drop").removeClass("is-active"))}).on("click","[js-print]",function(e){window.print()}),r.on("click",".mfp-close",function(){$.magnificPopup.close()}),r.one("focus.autoExpand",".ui-group textarea",function(){var e=this.value;this.value="",this.baseScrollHeight=this.scrollHeight,this.value=e}).on("input.autoExpand",".ui-group textarea",function(){var e,i=0|this.getAttribute("data-min-rows");this.rows=i,e=Math.ceil((this.scrollHeight-this.baseScrollHeight)/17),this.rows=i+e}),r.on("keyup","[js-search-hints]",debounce(function(e){if(e.preventDefault(),e.stopPropagation(),13!==e.keyCode){var i,a,s,t=$(this).val(),n=$(this).closest("[js-search-container]"),r=n.data("url"),o=n.find(".s-hints");if(t.length<=2)o.removeClass("is-active").removeClass("is-loaded");else l(),o.addClass("is-active").removeClass("is-loaded"),i=o.find(".s-hints__wrapper"),a=i[0].getBoundingClientRect().top,s=d.height(),i.css({"max-height":s-a-10+"px"}),t.match("^нет")?$.get("/json/api-hints-blank.json?q="+t).done(function(e){!function(e){var a=e.suggestions,s="";if(0<a.length){var t="";$.each(a,function(e,i){t+='<div class="s-hint-suggestion" data-query-name="'+i.name+'" data-query-value="'+i.value+'">'+i.label+"</div>",e===a.length-1&&(s+='<div class="s-hints__no-results"><div class="s-hints__no-results-text">К сожалению поиск не дал результатов. Попробуйте, например, добавить:</div><div class="s-hints__no-results-suggestions">'+t+"</div></div>")})}setTimeout(function(){l(),c(s)},1e3)}(e)}).fail(function(e){o.removeClass("is-active").removeClass("is-loaded"),console.log(e)}):$.get(r+"?q="+t).done(function(e){!function(e){var i=e.tags,t=e.items,n="";0<i.length&&$.each(i,function(e,i){var a="";$.each(i.items,function(e,i){a+='<li js-add-hint-tag data-query-value="'+i.value+'"><a href="#">'+i.label+"</a></li>"}),n+='\x3c!-- section  --\x3e<div class="s-hints__section" data-query-name="'+i.name+'"><div class="s-hints__section-name">'+i.title+'</div><ul class="s-hints__list">'+a+"</ul></div>"});if(0<t.length){var r="";$.each(t,function(e,i){var a=void 0!==i.price.postfix?i.price.postfix:"",s=void 0!==i.price.prefix?i.price.prefix:"";r+='<li><a class="s-hints-property" href="'+i.url+'" target="_blank"><div class="s-hints-property__image"><img src="'+i.images[0]+'" srcset="'+i.images[1]+' 2x"></div><div class="s-hints-property__content"><div class="s-hints-property__id">ID '+i.id+'</div><div class="s-hints-property__name">'+i.name+'</div><div class="s-hints-property__price">'+(s?"<span>"+s+"</span>":"")+i.price.value+" <span>"+a+"</span></div></div></a></li>",e===t.length-1&&(n+='<div class="s-hints__section"><div class="s-hints__section-name">Объекты недвижимости</div><ul class="s-hints__list">'+r+"</ul></div>")})}setTimeout(function(){l(),c(n)},1e3)}(e)}).fail(function(e){o.removeClass("is-active").removeClass("is-loaded"),console.log(e)})}function l(){o.find(".s-hints__section").remove(),o.find(".s-hints__no-results").remove()}function c(e){o.find(".s-hints__wrapper").append(e),o.addClass("is-loaded")}},200)).on("click","[js-close-hints]",function(){$(this).closest(".s-hints").removeClass("is-active").removeClass("is-loaded")}).on("click",function(e){(0<!$(e.target).closest(".header-search").length||0<!$(e.target).closest(".search-form").length)&&$(".s-hints").removeClass("is-active").removeClass("is-loaded")}).on("click","[js-add-hint-tag]",function(e){var i=$(this),a=$(this).closest("[js-search-container]"),s=i.data("query-value"),t=i.closest("[data-query-name]").data("query-name"),n=i.find("a").html(),r=a.find("[js-search-tags]");if(!(0<r.find('[data-query-value="'+s+'"]').length&&0<r.find('[data-query-name="'+t+'"]').length)){var o='<div data-query-name="'+t+'" data-query-value="'+s+'" class="s-hint-suggestion"> <span>'+n+'</span><svg class="ico ico-close"><use xlink:href="img/sprite.svg#ico-close"></use></svg></div>';$("[js-search-tags]").append(o),a.find("[js-search-hints]").val(""),C(t,s),i.closest("[js-search-container]").addClass("is-active"),y(a)}}).on("click",".s-hint-suggestion .ico-close",function(){$(this).parent().fadeOut(250,function(){var e=$(this),i=$(this).closest("[js-search-container]");e.data("query-value");j(e.closest("[data-query-name]").data("query-name"),null),$(this).remove(),y(i)})}).on("keydown","[js-search-hints]",function(e){13===e.keyCode&&$(this).closest("[js-search-container]").find(".s-hints__list li a").first().click()}).on("click","[js-search-reset]",function(){var e=$(this).closest("[js-search-container]"),i=e.find("[js-search-tags]"),a=e.find("[js-search-hints]");e.removeClass("is-active"),i.html(""),a.trigger("keyup"),a.val(""),j(null,null,!0),y(e)}),d.on("resize",debounce(function(){768<d.width()&&$(".search").attr("style",""),992<d.width()&&$(".search-form__name").css({"margin-bottom":0})},200)),Barba.Pjax.Dom.containerClass="page";var e=Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.fadeOut()]).then(this.fadeIn.bind(this))},fadeOut:function(){var i=Barba.Utils.deferred();return anime({targets:this.oldContainer,opacity:.5,easing:a,duration:300,complete:function(e){i.resolve()}}),i.promise},fadeIn:function(){var i=this,e=$(this.newContainer);$(this.oldContainer).hide(),e.css({visibility:"visible",opacity:.5}),anime({targets:"html, body",scrollTop:1,easing:a,duration:150}),anime({targets:this.newContainer,opacity:1,easing:a,duration:300,complete:function(e){S(),i.done()}})}});function S(e){e&&d.scrollTop(0),$(window).scroll(),$(window).resize()}function z(){var e=window.location.host.toLowerCase();if(0<=e.indexOf("localhost")||0<=e.indexOf("surge")){var i="<div class='dev-bp-debug'>"+d.width()+"</div>";$(".page").append(i),setTimeout(function(){$(".dev-bp-debug").fadeOut()},1e3),setTimeout(function(){$(".dev-bp-debug").remove()},1500)}}Barba.Pjax.getTransition=function(){return e},Barba.Prefetch.init(),Barba.Pjax.start(),Barba.Dispatcher.on("newPageReady",function(e,i,a,s){t(),l()})}),$.extend({getUrlVars:function(){for(var e,i=[],a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),s=0;s<a.length;s++)e=a[s].split("="),i.push(e[0]),i[e[0]]=e[1];return i},getUrlVar:function(e){return $.getUrlVars()[e]}});